<?php/** * Prospect model *  * @package NGaming */class CMProspect extends CObject{	public function __construct()	{		parent::__construct();	}		public function CreateProspect($acronym, $password, $name, $email)	{		return $this->user->Create($acronym, $password, $name, $email, array('prospect'));	}		public function ReadAll()	{		$ret = array();				$groupId = $this->database->Get('group', array('id'),array('acronym' => $this->config['CMUser-Groups']['prospect']['acronym']));				$groupId = $groupId[0]['id'];				$ret = $this->database->Get('user2group, user', array('user.id', 'acronym'), array('user2group.idGroup' => $groupId, 'user2group.idUser'=>"#user.id"));				return $ret;	}		public function Remove($id)	{		$user = $this->database->Get('user', array('id'), array('id'=>$id));		if (!empty($user))		{			$prospectId = $this->database->Get('group', array('id'), array('acronym' => $this->config['CMUser-Groups']['prospect']['acronym']));			$prospectId = $prospectId[0]['id'];			if ($this->database->Get('user2group', array('idUser'), array('idUser'=>$id, 'idGroup' => $prospectId)))			{				$this->database->Delete('user2group', array('idUser' => $id));				$this->database->Delete('user', array('id' => $id));				return true;			}			else			{				$this->session->AddMessage('error', 'Prospect is not in prospect group.');			}		}		else		{			$this->session->AddMessage('error', 'Prospect does not exist.');		}		return false;	}		public function Promote($id)	{		$user = $this->database->Get('user', array('id'), array('id'=>$id));		if (!empty($user))		{			$prospectId = $this->database->Get('group', array('id'), array('acronym' => $this->config['CMUser-Groups']['prospect']['acronym']));			$prospectId = $prospectId[0]['id'];			if ($this->database->Get('user2group', array('idUser'), array('idUser'=>$id, 'idGroup' => $prospectId)))			{				$dateTime = date('o-m-d H:i:s');								/*Remove from prospect group*/				$this->database->Delete('user2group', array('idUser' => $id));								/*Get user-group id*/				$groupId = $this->database->Get('group', array('id'), array('acronym' => $this->config['CMUser-Groups']['user']['acronym']));								$groupId = $groupId[0]['id'];								if ($this->database->Insert('user2group', array(					'idUser'	=> $id,					'idGroup'	=> $groupId,					'created'	=> $dateTime,					)				))				{					return true;				}			}			else			{				$this->session->AddMessage('error', 'Prospect is not in prospect group.');			}		}		else		{			$this->session->AddMessage('error', 'Prospect does not exist.');		}		return false;	}}